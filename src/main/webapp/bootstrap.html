<!DOCTYPE html>
<html>
<head>
<title>Stream上传插件 - Bootstrap Demo</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="/css/stream-v1.css" rel="stylesheet" type="text/css">
<link href="http://cdn.bootcss.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="http://cdn.bootcss.com/blueimp-file-upload/9.5.2/css/jquery.fileupload-ui.css" rel="stylesheet">
<!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
<![endif]-->
<style type="text/css">
.fileinput-button {
  position: relative;
  overflow: hidden;
}
.fileinput-button input {
  position: absolute;
  top: 0;
  right: 0;
  margin: 0;
  opacity: 0;
  filter: alpha(opacity=0);
  transform: translate(-300px, 0) scale(4);
  font-size: 23px;
  direction: ltr;
  cursor: pointer;
}
.fileupload-buttonbar .btn,
.fileupload-buttonbar .toggle {
  margin-bottom: 5px;
}
.progress-animated .progress-bar,
.progress-animated .bar {
  background: url(/images/progressbar.gif) !important;
  filter: none;
}
.fileupload-loading {
  float: right;
  width: 32px;
  height: 32px;
  background: url(/images/loading.gif) center no-repeat;
  background-size: contain;
  display: none;
}
.fileupload-processing .fileupload-loading {
  display: block;
}
.files audio,
.files video {
  max-width: 300px;
}

@media (max-width: 767px) {
  .fileupload-buttonbar .toggle,
  .files .toggle,
  .files .btn span {
    display: none;
  }
  .files .name {
    width: 80px;
    word-wrap: break-word;
  }
  .files audio,
  .files video {
    max-width: 80px;
  }
}
</style>
</head>
<body>

<div class="row">
  <div class="col-md-12">
     <blockquote>
        <p style="font-size:16px">Stream上传插件自定义UI<br>
           本UI是模仿File Upload的Html5形式下的UI风格，满足不同客户在某些情况下需要自定义UI的需求.<br>
        </p>
     </blockquote>
     <br>
		<form id="fileupload" action="">
			<div class="row fileupload-buttonbar">
				<div class="col-lg-7">
					<!-- The fileinput-button span is used to style the file input field as button -->
					<span class="btn green fileinput-button" id="i_select_files">
						<i class="icon-plus"></i> <span>Add files...</span>
					</span>
					<button type="submit" class="btn blue start">
						<i class="icon-upload"></i> <span>Start upload</span>
					</button>
					<button type="reset" class="btn yellow cancel">
						<i class="icon-ban-circle"></i> <span>Cancel upload</span>
					</button>
					<button type="button" class="btn red delete">
						<i class="icon-trash"></i> <span>Delete</span>
					</button>
				</div>
				<!-- The global progress information -->
				<div class="col-lg-5 fileupload-progress fade">
					<!-- The global progress bar -->
					<div class="progress progress-striped active" role="progressbar"
						aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
						<div class="progress-bar progress-bar-success" style="width: 10%;"></div>
					</div>
					<!-- The extended global progress information -->
					<div class="progress-extended">&nbsp;</div>
				</div>
			</div>
		</form>
		
		<!-- The table listing the files available for upload/download -->
		<table role="presentation" class="table table-striped clearfix">
			<tbody class="files" id="bootstrap-stream-container">
			</tbody>
		</table>
		<div class="alert alert-danger" id="stream_total_progress_bar">
			<div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
				<div class="progress-bar progress-bar-success" style="width: 0%;"></div>
			</div>
			<span class="stream_total_size"></span>
			<span class="stream_total_percent"></span>
		</div>
			
	</div>
</div>

<script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
<script src="http://cdn.bootcss.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/stream-v1.js"></script>
<script type="text/javascript">
/**
 * 配置文件（如果没有默认字样，说明默认值就是注释下的值）
 * 但是，on*（onSelect， onMaxSizeExceed...）等函数的默认行为
 * 是在ID为i_stream_message_container的页面元素中写日志
 */
	var config = {
		customered:true,
		multipleFiles: true,
		onAddTask: function(f) {
			 var file = '<tr id="' + f.id + '" class="template-upload fade in">' +
		     '<td><span class="preview"></span></td>' +
		     '<td><p class="name">' + f.name + '</p>' +
//		     '    <div><span class="label label-danger">Error</span> File type not allowed</div>' +
		     '    <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">' +
			'			<div class="progress-bar progress-bar-success" title="" style="width: 0%;"></div>' +
			'		</div>' +
		     '</td>' +
		     '<td><p class="size">' + f.formatSize + '</p>' +
		     '</td>' +
		     '<td><button class="btn red cancel" onClick="javascript:_t.cancelOne(\'' + f.id + '\')">' +
		     '       <i class="icon-ban-circle"></i>' +
		     '       <span>Cancel</span>' +
		     '    </button>' +
		     '</td></tr>';
			
			$("#bootstrap-stream-container").append(file);
		},
		onUploadProgress: function(f) {
			//console && console.log("-------------onUploadProgress-------------------");
			//console && console.log(f);
			
			var $bar = $("#"+f.id).find("div.progress-bar");
			$bar.css("width", f.percent + "%");
			$bar.attr("title", "已上传:" + f.formatLoaded + "/" + f.formatSize + "(" + f.percent + "%" + ") \n速  度:" + f.formatSpeed);
			
			var $total = $("#stream_total_progress_bar");
			$total.find("div.progress-bar").css("width", f.totalPercent + "%");
			$total.find("span.stream_total_size").html(f.formatTotalLoaded + "/" + f.formatTotalSize);
			$total.find("span.stream_total_percent").html(f.totalPercent + "%");
			
			//console && console.log("-------------onUploadProgress-------------------End");
		},
		onCancel: function(info) {
			//console && console.log("-------------onCancel-------------------");
			//console && console.log(info);
			
			$("#"+info.id).remove();
			
			//console && console.log("-------------onCancel-------------------End");
		},
		onComplete: function(f) {
			//console && console.log("-------------onComplete-------------------");
			//console && console.log(f);
			
			/** 100% percent */
			var $bar = $("#"+f.id).find("div.progress-bar");
			$bar.css("width", f.percent + "%");
			$bar.attr("title", "已上传:" + f.formatLoaded + "/" + f.formatSize + "(" + f.percent + "%" + ")");
			/** remove the `cancel` button */
			var $cancelBtn = $("#"+f.id).find("td > button");
			$cancelBtn.remove();
			
			/** modify the total progress bar */
			var $total = $("#stream_total_progress_bar");
			$total.find("div.progress-bar").css("width", f.totalPercent + "%");
			$total.find("span.stream_total_size").html(f.formatTotalLoaded + "/" + f.formatTotalSize);
			$total.find("span.stream_total_percent").html(f.totalPercent + "%");
			
			//console && console.log("-------------onComplete-------------------End");
		}
	};
	var _t = new Stream(config);
</script>
</body>